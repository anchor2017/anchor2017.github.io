---
layout:     post
title:      UCOSIII
subtitle:   
date:       2020-03-31
author:     蔡银锚
header-img:
catalog: true
tags:
    - UCOSIII
---


##UCOSIII

##QA

- 为什么在给外设进行初始化的时候不允许发生任务调度？
- 时钟节拍是指定时中断周期吗？
- UCOSIII的开始任务函数是必须的吗？
- 一个系统时钟节拍是什么？



# 文件系统

文件系统是对数据的一种管理方式，可以有效地管理计算机存储介质。

# Critical Section

（临界区）每个线程用来访问临界资源的那段程序被称为临界区。（临界资源：不同线程共享的资源）

# UCOSIII

1. UCOSIII创建一个任务包括5个步骤
   1. 任务控制块：当一个任务被剥夺了CPU控制权的时候，任务控制块可以保存任务的状态，当任务得到CPU控制权的时候可以从断点处开始执行。

```
#define START_TASK_PRIO 3
#define START_STK_SIZE 512
OS_TCB StartTaskTCB;
CPU_STK START_TASK_STK[START_STK_SIZE];
//不是很清楚传进去的是一个指向什么的指针，指向变量的指针吗？可是变量那么多
void start_task(void *p_arg);
```

1. OSTCBbl[]：任务控制块数组，所有任务都保存在这个数组中。
2. OSTCBPrioTbl[]：任务控制块优先级表，专门用来存放指向各任务块的指针，并按任务的优先级将这些指针存放在数组的各个元素里面，利用数组的下标可以体现优先级。
3. OSTCBList指针指向当前的用户任务。
4. OSTCBFreeList指针指向CPU空闲任务。
5. 从任务的存储结构来看，UCOSIII包括任务程序代码，任务控制块，任务堆栈3个部分。任务控制块关联各个任务程序代码，保存任务的属性；任务堆栈保存任务的工作环境；任务程序代码是任务的执行部分。
6. UCOSIII有5个优先级用户不能使用。0，1，2，[MAX-2]，[MAX-1].
7. 创建任务要先进入临界区，然后创建任务，然后退出临界区。也就是一次只能创建一个任务。退出临界区之后就可以开启UCOSIII(OSStart(&err);)
8. 在进入函数的过程中，如果传进去的是变量的指针，那么将不会重新为变量分配新的内存，而是直接在原来的地址上进行操作。而直接传进去变量，将会重新创建一块内存。
9. 在多任务开始或者正在运行的任务之前不能创建任务。
10. 任务在被创建成功之后会返回一个指向该TCB的指针，该指针可以作为该任务的ID(地址)。

# ROM, RAM, FLASH

## RAM

RAM(Random Access Memory随机存取寄存器，掉电不保存)，在计算机中被称为内存，保存当前程序的运行状态（数据及变量值）。

# 

RAM分为好多种(主要由于采用的技术不同)，有DRAM(Dynamic Random Access Memory动态只读存储器)。DRAM需要每次不停地对数据进行刷新，刷新的方式为先检测保存数据的电容是否大于其原来电容的二分之一，然后选择是否进行再次对电容进行充电（也就是需要不停地对数据进行刷新，不然时间过久了数据会丢失的，因为储存数据的电容会放电（电容满电表示1，电容无电表示0））。 优点：速度快 缺点：掉电不保存

# 

SRAM(Static Random Access Memory动态随机存取寄存器)速度最快。采用将数据存储在寄存器中（暂时不明白为什么存储在寄存器中数据就不需要不停地刷新）。

## ROM

ROM(Read Only Memory只读存储器)也分为好多种，有PROM, E2PROM…… 优点：掉电保存 缺点：数据存储的时间长，读取的时间也长

## FLASH

FLASH兼具有RAM和ROM的优点

# SVC和PendVC

(systerm serve call, pend serve call)系统服务调用和可挂起系统调用

# RTOS

(Real-Time Operating Systerm)



- 终于知道为什么串口那部分不作为操作系统里面的一个任务了，因为经常需要这个函数来进行打印，然后显示在串口助手那里。所以，最后是把串口这个功能作为一个中断来实现的。后来发现不是的，串口是在main.c中有初始化，然后在任务中有调用。
- 在OSInit();函数里面，有关于uCosIII的三个系统任务。其中，空闲任务和时钟节拍任务（滴答）是在这个函数里面创建的。
- 对于uCosIII操作系统来说，它的时钟节拍是很重要的，就像是它的心脏一样。它的这个时钟节拍就是它的延时函数的一个基准时间。uCosIII创建任务的时候，是进入了临界区。
- UCOSIII的void OSTimeDlyHMSM(); 延时只可以延时到ms
